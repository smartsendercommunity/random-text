# random-text
Отправка текстов из файла в рандомном порядке


Скрипт позволяет отправлять пользователю один из указаных в файле текстов и/или изображений в рандомном порядке. Данный скрипт будет полезен тем, кто хочет сделать бота более "живым". Например отправлять разные версии приветствий, благодарностей или просто бот с предсказаниями


Инструкция по использованию:
1. Загрузить скрипт на собственный хостинг
2. Разместить возле скрипта текстовые файлы с фразами согласно шаблону (имеются в комплекте). Если просто текст, то в качестве шаблона можно использовать файл test.txt, в котором версии текстов разделены двумя дефисами в отдельной строке. Если должны отправлятся изображения и/или другой контент, то в качестве шаблона необходимо использовать файл test.json, в котором должен находится массив обьектов, представляющих отправляемое сообщение согласно документации API Smart Sender https://smartsendereu.atlassian.net/wiki/spaces/docsru/pages/97288213/Messages+API (параметр watermark можно не указывать, он добавляется автоматически)
3. Разместить в нужном месте воронки блок Действие - Внешний запрос на скрипт со следующим телом запроса:
```
{
    "userId":"{{ userId }}",
    "file":"test.json",
    "mode":"send",
    "token":"{{ API SS }}"
}
```

Поддерживаемые параметры:
- userId - идентификатор пользователя (обезательно)
- file - имя (относительный путь) файла, в котором находится набор контента для отправки
- mode - режим работы: send - отправить, любое другое значение или отсутствие параметра не отправляет сообщение автоматически. В любом случае в ответе скрипта имеется подобранная фраза, разделена по 250 символов для сохранения в переменную
- token - токен проекта для отправки сообщения (обезательно, если mode=send)
- clear - очистить очередь отправки. Если значение - true, то скрипт "забудет" что уже отправлял и что еще нужно отправить и перемешает все фразы заново и составит новую очередь отправки. В качестве альтернативы этого параметра можно удалить папку collection или ее содержимое (эта папка создается скриптом автоматически)
- global - общая очередь. Если значение true - используется общая очередь сообщений к отправке. Тоесть все сообщения перемешиваются один раз и каждый запрос на отправку берет сообщение из одного набора. Таким образом каждый пользователь будет получать уникальное сообщение, пока не закончится набор (после этого весь набор перемешивается заново). При отсутствии параметра каждому пользователю отдельно создается перемешаный набор отправляемых сообщений, которые не пересекаются между собой



Стоит также обратить на параметр caption в шаблонном файле test.json Это описание картинки, которое отправляется пользователю вместе с картинкой в одном сообщении, но поддерживается он только в мессенджерах Telegram и Viber. В остальных мессенджерах картинка будет отправлятся без текста
